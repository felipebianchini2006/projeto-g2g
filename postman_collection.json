{
  "info": {
    "name": "G2G API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:3001" },
    { "key": "accessToken", "value": "" },
    { "key": "adminToken", "value": "" },
    { "key": "refreshToken", "value": "" },
    { "key": "listingId", "value": "" },
    { "key": "orderId", "value": "" },
    { "key": "disputeId", "value": "" }
  ],
  "item": [
    {
      "name": "Autenticacao",
      "item": [
        {
          "name": "Registrar",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{baseUrl}}/auth/register",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"buyer@g2g.test\",\n  \"password\": \"StrongPass123\",\n  \"role\": \"USER\"\n}"
            }
          }
        },
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{baseUrl}}/auth/login",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"buyer@g2g.test\",\n  \"password\": \"StrongPass123\"\n}"
            }
          }
        },
        {
          "name": "Refresh",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{baseUrl}}/auth/refresh",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}"
            }
          }
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{baseUrl}}/auth/logout",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Listings",
      "item": [
        {
          "name": "Lista publica",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/public/listings"
          }
        },
        {
          "name": "Categorias publicas",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/public/categories"
          }
        },
        {
          "name": "Criar listing (seller)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/listings",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"categoryId\": \"category-uuid\",\n  \"title\": \"Conta Steam\",\n  \"description\": \"Conta com jogos premium\",\n  \"priceCents\": 4990,\n  \"currency\": \"BRL\",\n  \"deliveryType\": \"AUTO\",\n  \"deliverySlaHours\": 24,\n  \"refundPolicy\": \"Reembolso em ate 7 dias.\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Pedidos",
      "item": [
        {
          "name": "Checkout",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/checkout",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"listingId\": \"{{listingId}}\",\n  \"quantity\": 1\n}"
            }
          }
        },
        {
          "name": "Listar pedidos",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/orders"
          }
        },
        {
          "name": "Obter pedido",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/orders/{{orderId}}"
          }
        },
        {
          "name": "Cancelar pedido",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/orders/{{orderId}}/cancel",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"Comprador desistiu\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Pagamentos",
      "item": [
        {
          "name": "Criar Pix para pedido",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/payments/pix/create",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"orderId\": \"{{orderId}}\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Webhooks",
      "item": [
        {
          "name": "Webhook Pix (simular)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{baseUrl}}/webhooks/efi/pix",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"evento\": \"pix\",\n  \"pix\": [\n    {\n      \"txid\": \"pix-txid\",\n      \"endToEndId\": \"e2e-id\",\n      \"horario\": \"2026-01-08T12:10:00.000Z\"\n    }\n  ]\n}"
            }
          }
        },
        {
          "name": "Registrar webhook (admin)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "url": "{{baseUrl}}/webhooks/efi/register",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"webhookUrl\": \"https://example.com/webhooks/efi/pix\"\n}"
            }
          }
        },
        {
          "name": "Metricas webhook (admin)",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "url": "{{baseUrl}}/webhooks/efi/metrics"
          }
        }
      ]
    },
    {
      "name": "Admin",
      "item": [
        {
          "name": "Liberar pedido",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "url": "{{baseUrl}}/admin/orders/{{orderId}}/release",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"Liberacao manual\"\n}"
            }
          }
        },
        {
          "name": "Resolver disputa parcial",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "url": "{{baseUrl}}/admin/disputes/{{disputeId}}/resolve",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"partial\",\n  \"amountCents\": 2500,\n  \"reason\": \"Entrega parcial\"\n}"
            }
          }
        },
        {
          "name": "Listar usuarios",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "url": "{{baseUrl}}/admin/users"
          }
        }
      ]
    },
    {
      "name": "Saude",
      "item": [
        {
          "name": "Health",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/health"
          }
        },
        {
          "name": "Ready",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/ready"
          }
        }
      ]
    }
  ]
}
